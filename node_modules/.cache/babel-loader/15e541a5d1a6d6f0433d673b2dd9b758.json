{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext}from'react';import'./Auth.css';import Card from'../../shared/components/UIElements/Card';import Button from'../../shared/components/FormElements/Button';import Input from'../../shared/components/FormElements/Input';import ErrorModal from'../../shared/components/UIElements/ErrorModal';import LoadingSpinner from'../../shared/components/UIElements/LoadingSpinner';import ImageUpload from'../../shared/components/FormElements/ImageUpload';import{VALIDATOR_EMAIL,VALIDATOR_MINLENGTH,VALIDATOR_REQUIRE}from'../../shared/util/validators';import{useForm}from'../../shared/hooks/form-hook';import{AuthContext}from'../../shared/context/auth-context';import{useHttpClient}from'../../shared/hooks/http-hook';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Auth=function Auth(){var auth=useContext(AuthContext);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoginMode=_useState2[0],setIsLoginMode=_useState2[1];var _useHttpClient=useHttpClient(),isLoading=_useHttpClient.isLoading,error=_useHttpClient.error,sendRequest=_useHttpClient.sendRequest,clearError=_useHttpClient.clearError;var _useForm=useForm({email:{value:'',isValid:false},password:{value:'',isValid:false}},false),_useForm2=_slicedToArray(_useForm,3),formState=_useForm2[0],inputHandler=_useForm2[1],setFormData=_useForm2[2];var switchModeHandler=function switchModeHandler(){if(!isLoginMode){setFormData(_objectSpread(_objectSpread({},formState.inputs),{},{name:undefined,image:undefined}),formState.inputs.email.isValid&&formState.inputs.password.isValid);}else{setFormData(_objectSpread(_objectSpread({},formState.inputs),{},{name:{value:'',isValid:false},image:{value:null,isValid:false}}),false);}setIsLoginMode(function(prevMode){return!prevMode;});};var authSubmitHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var responseData,formData,_responseData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();if(!isLoginMode){_context.next=13;break;}_context.prev=2;_context.next=5;return sendRequest(process.env.REACT_APP_BACKEND_URL+'/users/login','POST',JSON.stringify({email:formState.inputs.email.value,password:formState.inputs.password.value}),{'Content-Type':'application/json'});case 5:responseData=_context.sent;auth.login(responseData.userId,responseData.token);_context.next=11;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);case 11:_context.next=27;break;case 13:_context.prev=13;formData=new FormData();formData.append('email',formState.inputs.email.value);formData.append('name',formState.inputs.name.value);formData.append('password',formState.inputs.password.value);formData.append('image',formState.inputs.image.value);_context.next=21;return sendRequest(process.env.REACT_APP_BACKEND_URL+'/users/signup','POST',formData);case 21:_responseData=_context.sent;auth.login(_responseData.userId,_responseData.token);_context.next=27;break;case 25:_context.prev=25;_context.t1=_context[\"catch\"](13);case 27:case\"end\":return _context.stop();}},_callee,null,[[2,9],[13,25]]);}));return function authSubmitHandler(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ErrorModal,{error:error,onClear:clearError}),/*#__PURE__*/_jsxs(Card,{className:\"authentication\",children:[isLoading&&/*#__PURE__*/_jsx(LoadingSpinner,{asOverlay:true}),/*#__PURE__*/_jsx(\"h2\",{children:\"Login Required\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:authSubmitHandler,children:[!isLoginMode&&/*#__PURE__*/_jsx(Input,{element:\"input\",id:\"name\",type:\"text\",label:\"Your Name\",validators:[VALIDATOR_REQUIRE()],errorText:\"Please enter a name.\",onInput:inputHandler}),/*#__PURE__*/_jsx(Input,{element:\"input\",id:\"email\",type:\"email\",label:\"E-Mail\",validators:[VALIDATOR_EMAIL()],errorText:\"Please enter a valid email address.\",onInput:inputHandler}),/*#__PURE__*/_jsx(Input,{element:\"input\",id:\"password\",type:\"password\",label:\"Password\",validators:[VALIDATOR_MINLENGTH(6)],errorText:\"Please enter a valid password, at least 6 characters.\",onInput:inputHandler}),!isLoginMode&&/*#__PURE__*/_jsx(ImageUpload,{center:true,id:\"image\",onInput:inputHandler,errorText:\"Please provide an image.\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:!formState.isValid,children:isLoginMode?'LOGIN':'SIGNUP'})]}),/*#__PURE__*/_jsxs(Button,{inverse:true,onClick:switchModeHandler,children:[\"SWITCH TO \",isLoginMode?'SIGNUP':'LOGIN']})]})]});};export default Auth;","map":{"version":3,"names":["React","useState","useContext","Card","Button","Input","ErrorModal","LoadingSpinner","ImageUpload","VALIDATOR_EMAIL","VALIDATOR_MINLENGTH","VALIDATOR_REQUIRE","useForm","AuthContext","useHttpClient","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Auth","auth","_useState","_useState2","_slicedToArray","isLoginMode","setIsLoginMode","_useHttpClient","isLoading","error","sendRequest","clearError","_useForm","email","value","isValid","password","_useForm2","formState","inputHandler","setFormData","switchModeHandler","_objectSpread","inputs","name","undefined","image","prevMode","authSubmitHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","responseData","formData","_responseData","wrap","_callee$","_context","prev","next","preventDefault","process","env","REACT_APP_BACKEND_URL","JSON","stringify","sent","login","userId","token","t0","FormData","append","t1","stop","_x","apply","arguments","children","onClear","className","asOverlay","onSubmit","element","id","type","label","validators","errorText","onInput","center","disabled","inverse","onClick"],"sources":["/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/src/user/pages/Auth.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\n\r\nimport './Auth.css'\r\nimport Card from '../../shared/components/UIElements/Card';\r\nimport Button from '../../shared/components/FormElements/Button';\r\nimport Input from '../../shared/components/FormElements/Input';\r\nimport ErrorModal from '../../shared/components/UIElements/ErrorModal'\r\nimport LoadingSpinner from '../../shared/components/UIElements/LoadingSpinner';\r\nimport ImageUpload from '../../shared/components/FormElements/ImageUpload';\r\nimport {\r\n    VALIDATOR_EMAIL,\r\n    VALIDATOR_MINLENGTH,\r\n    VALIDATOR_REQUIRE\r\n  } from '../../shared/util/validators';\r\nimport { useForm } from '../../shared/hooks/form-hook';\r\nimport { AuthContext } from '../../shared/context/auth-context';\r\nimport { useHttpClient } from '../../shared/hooks/http-hook';\r\n\r\n\r\nconst Auth = () => {\r\n  const auth = useContext(AuthContext);\r\n  const [isLoginMode, setIsLoginMode] = useState(true);\r\n  const { isLoading, error, sendRequest, clearError } = useHttpClient();\r\n\r\n  const [formState, inputHandler, setFormData] = useForm(\r\n        {\r\n          email: {\r\n            value: '',\r\n            isValid: false\r\n          },\r\n          password: {\r\n            value: '',\r\n            isValid: false\r\n          }\r\n        },\r\n        false\r\n      );\r\n    \r\n    const switchModeHandler = () => {\r\n        if (!isLoginMode) {\r\n          setFormData(\r\n            {\r\n              ...formState.inputs,\r\n              name: undefined,\r\n              image: undefined\r\n            },\r\n            formState.inputs.email.isValid && formState.inputs.password.isValid\r\n          );\r\n        } else {\r\n          setFormData(\r\n            {\r\n              ...formState.inputs,\r\n              name: {\r\n                value: '',\r\n                isValid: false\r\n              },\r\n              image: {\r\n                value: null,\r\n                isValid: false\r\n              }\r\n            },\r\n            false\r\n          );\r\n        }\r\n        setIsLoginMode(prevMode => !prevMode);\r\n      };\r\n\r\n    const authSubmitHandler = async event => {\r\n        event.preventDefault();\r\n\r\n        if (isLoginMode) {\r\n          try {\r\n            const responseData = await sendRequest(\r\n              process.env.REACT_APP_BACKEND_URL +'/users/login', \r\n              'POST',\r\n            JSON.stringify({\r\n              email: formState.inputs.email.value,\r\n              password: formState.inputs.password.value\r\n            }),\r\n             {\r\n                'Content-Type': 'application/json'\r\n              }\r\n            );\r\n            auth.login(responseData.userId, responseData.token);\r\n          }catch (err) {}  \r\n        }else{\r\n          try{\r\n            const formData = new FormData();\r\n            formData.append('email', formState.inputs.email.value);\r\n            formData.append('name', formState.inputs.name.value);\r\n            formData.append('password', formState.inputs.password.value);\r\n            formData.append('image', formState.inputs.image.value);\r\n            const responseData = await sendRequest(\r\n              process.env.REACT_APP_BACKEND_URL +'/users/signup', \r\n              'POST',\r\n              formData\r\n            );\r\n            \r\n            auth.login(responseData.userId, responseData.token);\r\n          }catch(err) {}\r\n      }  \r\n    };\r\n    \r\n  return (\r\n    <>\r\n    <ErrorModal error={error} onClear={clearError} />\r\n    <Card className=\"authentication\">\r\n    {isLoading && <LoadingSpinner asOverlay />}\r\n      <h2>Login Required</h2>\r\n      <hr />\r\n      <form onSubmit={authSubmitHandler}>\r\n        {!isLoginMode && (\r\n          <Input\r\n            element=\"input\"\r\n            id=\"name\"\r\n            type=\"text\"\r\n            label=\"Your Name\"\r\n            validators={[VALIDATOR_REQUIRE()]}\r\n            errorText=\"Please enter a name.\"\r\n            onInput={inputHandler} />\r\n        )}\r\n        <Input\r\n          element=\"input\"\r\n          id=\"email\"\r\n          type=\"email\"\r\n          label=\"E-Mail\"\r\n          validators={[VALIDATOR_EMAIL()]}\r\n          errorText=\"Please enter a valid email address.\"\r\n          onInput={inputHandler} />\r\n        <Input\r\n          element=\"input\"\r\n          id=\"password\"\r\n          type=\"password\"\r\n          label=\"Password\"\r\n          validators={[VALIDATOR_MINLENGTH(6)]}\r\n          errorText=\"Please enter a valid password, at least 6 characters.\"\r\n          onInput={inputHandler} />\r\n        {!isLoginMode && <ImageUpload center id=\"image\" onInput={inputHandler} errorText='Please provide an image.'/>}\r\n        <Button type=\"submit\" disabled={!formState.isValid}>\r\n          {isLoginMode ? 'LOGIN' : 'SIGNUP'}\r\n        </Button>\r\n      </form>\r\n      <Button inverse onClick={switchModeHandler}>\r\n        SWITCH TO {isLoginMode ? 'SIGNUP' : 'LOGIN'}\r\n      </Button>\r\n    </Card></>\r\n   )\r\n\r\n};\r\n\r\nexport default Auth;"],"mappings":"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"},"metadata":{},"sourceType":"module"}