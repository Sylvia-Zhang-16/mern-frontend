{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useCallback,useRef,useEffect}from'react';export var useHttpClient=function useHttpClient(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var activeHttpRequests=useRef([]);var sendRequest=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(url){var method,body,headers,httpAbortCtrl,response,responseData,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:method=_args.length>1&&_args[1]!==undefined?_args[1]:'GET';body=_args.length>2&&_args[2]!==undefined?_args[2]:null;headers=_args.length>3&&_args[3]!==undefined?_args[3]:{};setIsLoading(true);httpAbortCtrl=new AbortController();activeHttpRequests.current.push(httpAbortCtrl);_context.prev=6;_context.next=9;return fetch(url,{method:method,body:body,headers:headers,signal:httpAbortCtrl.signal});case 9:response=_context.sent;_context.next=12;return response.json();case 12:responseData=_context.sent;activeHttpRequests.current=activeHttpRequests.current.filter(function(reqCtrl){return reqCtrl!==httpAbortCtrl;});if(response.ok){_context.next=16;break;}throw new Error(responseData.message);case 16:setIsLoading(false);return _context.abrupt(\"return\",responseData);case 20:_context.prev=20;_context.t0=_context[\"catch\"](6);setError(_context.t0.message);setIsLoading(false);throw _context.t0;case 25:case\"end\":return _context.stop();}},_callee,null,[[6,20]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);var clearError=function clearError(){setError(null);};useEffect(function(){return function(){// eslint-disable-next-line react-hooks/exhaustive-deps\nactiveHttpRequests.current.forEach(function(abortCtrl){return abortCtrl.abort();});};},[]);return{isLoading:isLoading,error:error,sendRequest:sendRequest,clearError:clearError};};","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","useHttpClient","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","_useState3","_useState4","error","setError","activeHttpRequests","sendRequest","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","url","method","body","headers","httpAbortCtrl","response","responseData","_args","arguments","wrap","_callee$","_context","prev","next","length","undefined","AbortController","current","push","fetch","signal","sent","json","filter","reqCtrl","ok","Error","message","abrupt","t0","stop","_x","apply","clearError","forEach","abortCtrl","abort"],"sources":["/Users/sylviazhang/Documents/software-development/projects/MERN/mern-frontend/src/shared/hooks/http-hook.js"],"sourcesContent":["import { useState, useCallback, useRef, useEffect } from 'react';\r\n\r\nexport const useHttpClient = () => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState();\r\n\r\n  const activeHttpRequests = useRef([]);\r\n\r\n  const sendRequest = useCallback(\r\n    async (url, method = 'GET', body = null, headers = {}) => {\r\n      setIsLoading(true);\r\n      const httpAbortCtrl = new AbortController();\r\n      activeHttpRequests.current.push(httpAbortCtrl);\r\n\r\n      try {\r\n        const response = await fetch(url, {\r\n          method,\r\n          body,\r\n          headers,\r\n          signal: httpAbortCtrl.signal\r\n        });\r\n\r\n        const responseData = await response.json();\r\n\r\n        activeHttpRequests.current = activeHttpRequests.current.filter(\r\n          reqCtrl => reqCtrl !== httpAbortCtrl\r\n        );\r\n\r\n        if (!response.ok) {\r\n          throw new Error(responseData.message);\r\n        }\r\n\r\n        setIsLoading(false);\r\n        return responseData;\r\n      } catch (err) {\r\n        setError(err.message);\r\n        setIsLoading(false);\r\n        throw err;\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const clearError = () => {\r\n    setError(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      activeHttpRequests.current.forEach(abortCtrl => abortCtrl.abort());\r\n    };\r\n  }, []);\r\n\r\n  return { isLoading, error, sendRequest, clearError };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}